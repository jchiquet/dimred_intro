---
title: "Tutorial on Dimensionality Reduction"
subtitle: "Some recents approches in statistics and machine learning"
author: "Julien Chiquet"
institute: "UMR MIA Paris-Saclay, AgroParisTech, INRAE"
date: 05/25/2023
date-format: long
format: beamer
execute:
    freeze: auto    
---


```{r settings-reticulate, include=FALSE}
library(reticulate)
reticulate::virtualenv_create("dimred")
reticulate::virtualenv_install(envname = "dimred", packages = c("matplotlib", "pyplnmodels", "jaxlib", "statsmodels", "scikit-learn"))
reticulate::virtualenv_install(envname = "dimred", packages = "xpcax", pip_options = "--upgrade --extra-index-url https://forgemia.inra.fr/api/v4/projects/8098/packages/pypi/simple")
reticulate::use_virtualenv("dimred")
```

# Introduction

{{< include introduction.qmd >}}

# Background: Geometric view of PCA

{{< include pca-geom.qmd >}}

{{< include pca-scRNA.qmd >}}

## Reconstruction formula

Recall that $\mathbf{F} = (\mathbf{f}_1, \dots, \mathbf{f}_p)$ is the matrix of Principal components. Then,

  - $\mathbf{f}_k = \bX^c \bv_k$ for projection on axis $k$
  - $\mathbf{F} = \bX^c \bV$ for all axis.

Using orthogonality of $\bV$, we get back the original data as follows, without loss ($\bV^T$ performs the inverse rotation of $\bV$):
\begin{equation*}
  \bX^c = \mathbf{F}\bV^\top
\end{equation*}

We obtain an approximation $\tilde{\bX}^c$ (compression) of the data $\bX^c$ by considering a subset $\mathcal{S}$ of PC, typically $\mathcal{S} = {1, \dots, q}$ with $q \ll p$.

\begin{equation*}
  \tilde{\bX}^c = \mathbf{F}_{\mathcal{S}}{\bV_{\mathcal{S}}}^\top = \bX^c \bV_{\mathcal{S}} {\bV_{\mathcal{S}}}^\top
\end{equation*}

$\rightsquigarrow$ This is a rank-$q$ approximation of $\bX$ (captured by the first $q$ axes).

{{< include pca-mnist.qmd >}}

{{< include pca-limitations.qmd >}}

# Reconstruction error approach

{{< include reconstruction_error_viewpoint.qmd >}}

{{< include NMF.qmd >}}

{{< include kernelPCA.qmd >}}

# Model-based approach

{{< include ppca.qmd >}}

{{< include plnpca-scRNA.qmd >}}

{{< include auto-encoders.qmd >}}

# Manifold learning (preserving pairwise relations)

{{< include relation_preservation_viewpoint.qmd >}}

{{< include MDS.qmd >}}

{{< include tSNE.qmd >}}

{{< include probabilistic-tSNE.qmd >}}

## References {.allowframebreaks}

::: {#refs}
:::
