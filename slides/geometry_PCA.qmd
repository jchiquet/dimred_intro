# Geometric approach to PCA

## Cloud of observation in $\Rset^p$

Individuals can be represented in the \alert{variable space $\Rset^p$} as a point cloud

:::: {.columns}

::: {.column width="45%"}

![Example in $\Rset^3$](figs_pca/cloud_centering.jpg){width="60%"}

:::

::: {.column width="45%"}

#### Center of Inertia

(or barycentrum, or empirical mean)

\begin{equation*}
\bar{\bx} = \frac{1}{n} \sum _{i=1}^n \bx_i =
      \begin{pmatrix}
        \sum _{i=1}^n x_{i1}/n \\
        \sum _{i=1}^n x_{i2}/n \\
        \vdots\\
        \sum _{i=1}^n x_{ip}/n
      \end{pmatrix}
\end{equation*}

:::

::::

We center the cloud $\bX$ around $\bx$ denote this by $\bX^c$

\begin{equation*}
  \bX^c = \begin{pmatrix}
  x_{11} - \bar{x}_1 &   \dots & x_{1j}  - \bar{x}_j & \dots  & x_{1p} - \bar{x}_p   \cr
            \vdots   &  \vdots & \vdots              & \vdots & \vdots  \cr
  x_{i1} - \bar{x}_1 &   \dots & x_{ij} - \bar{x}_j  & \dots  & x_{ip}  - \bar{x}_p \cr
            \vdots   &  \vdots & \vdots              & \vdots & \vdots  \cr
  x_{n1} - \bar{x}_1 &  \dots  & x_{nj} - \bar{x}_j  & \dots  & x_{np}  - \bar{x}_p \cr
  \end{pmatrix}
\end{equation*}

## Inertia and Variance

\paragraph{Total Inertia:} distance of the individuals to the center of the cloud

\begin{equation*}
    I_T = \frac{1}{n}\sum_{i=1}^n \sum_{j=1}^p  (x_{ij}- \bar{x}_{j}) ^2
    = \frac{1}{n}\sum_{i=1}^n \|\bx_i - \bar{\bx} \|^2
    = \frac{1}{n}\sum_{i=1}^n \distance^2 (\bx_i,\bar{\bx})
\end {equation*}

#### Proportional to the total variance

Let $\hat{\bSigma}$ be the empirical variance-covariance matrix
\begin{equation*}
      I_T = \frac{1}{n}\sum_{j=1}^p  \sum_{i=1}^n (x_{ij}- \bar{x}_{j}) ^2
      = \sum_{j=1}^p \frac{1}{n}\|\bx^j - \bar{x}_{j} \|^2
      = \sum_{j=1}^p \var(\bx^j) = \trace{\hat{\bSigma}}
\end{equation*}

$\rightsquigarrow$ \alert{Good representation has large inertia} (much variability)

$\rightsquigarrow$ \alert{Large dispertion $\sim$ Large distances between points}

## Inertia with respect to an axis

The Inertia of the cloud wrt axe $\Delta$ is the sum of the distances between all points and their orthogonal projection on $\Delta$.

\begin{equation*}
  \begin{aligned}
    I_\Delta = \frac{1}{n}\sum_{i=1}^n \distance^2(\bx_i, \Delta)
    \end{aligned}
\end{equation*}

![Projection of $\bx_i$ onto a line $\Delta$ passing through $\bar\bx$](figs_pca/proj_axis.jpg){width="60%"}

## Decomposition of total Inertia (1)

Let $\Delta^\bot$ be the orthogonal subspace of $\Delta$ in $\Rset^p$

![](figs_pca/supp_spaces.jpg){width="50%"}

::: {#thm-huygens}

## Huygens

A consequence of the above (Pythagoras Theorem) is the decomposition of the following total inertia:

\begin{equation*}
  I_T = I_{\Delta} + I_{\Delta^\bot}
\end{equation*}

\alert{By projecting the cloud $\bX$ onto $\Delta$, with loss the inertia measured by $\Delta^\bot$}

:::

## Decomposition of total Inertia (2)

Consider only subspaces with dimension $1$ (that is, lines or axes). We can decompose $\Rset^p$ as the sum of $p$ othogonal axis.

\begin{equation*}
  \Rset^p = \Delta_1 \oplus \Delta_2 \oplus \dots \oplus \Delta_p
\end{equation*}

\alert{$\rightsquigarrow$ These axes form a new basis for representing the point cloud.}

::: {#thm-huygens2}

## Huygens

\begin{equation*}
  I_{T} = I_{\Delta_1} + I_{\Delta_2} + \dots + I_{\Delta_p}
\end{equation*}

:::
