load("../../data/pollen_test_data.RData")
dim(pollen$data)
pollen$data
pollen$celltypes
barplot(pollen$celltypes)
class(pollen$celltypes)
barplot(table(pollen$celltypes))
library(tidyverse)
load("../../data/pollen_test_data.RData")
scRNA <-  %>% pollen$data %>% t() %>% as.tibble() %>%
%>% add_column(cell_types = pollen$celltypes)
scRNA <-  %>% pollen$data %>% t() %>% as.tibble() %>%
add_column(cell_types = pollen$celltypes)
load("../../data/pollen_test_data.RData")
scRNA <-  pollen$data %>% t() %>% as.tibble() %>%
add_column(cell_types = pollen$celltypes)
load("../../data/pollen_test_data.RData")
scRNA <-  pollen$data %>% t() %>% as_tibble() %>%
add_column(cell_types = pollen$celltypes)
scRNA %>% dplyr::select(cell_type) %>% summary() %>% knitr::kable("latex")
scRNA <-  pollen$data %>% t() %>% as_tibble() %>%
add_column(cell_type = pollen$celltypes)
scRNA %>% dplyr::select(cell_type) %>% summary() %>% knitr::kable("latex")
load("../../data/pollen_test_data.RData")
scRNA <-  pollen$data %>% t() %>% as_tibble() %>%
add_column(cell_type = pollen$celltypes)
scRNA %>% dplyr::select(cell_type) %>% summary() %>% knitr::kable()
dim(scRNA)
nlevels(scRNA$cell_type)
library(devtools)
install_github('gongx030/scDatasets')
library(scDatasets)
library(SummarizedExperiment)
data(pollen)
pollen
as_tibble(pollen)
str(pollen)
class(pollen)
?SummarizedExperiment
colData(pollen)
?pollen
toMatrix(pollen)
assys(pollen)
assays(pollen)
assays(pollen)[1, ]
assays(pollen)[[1]]
dim(assays(pollen)[[1]])
glimpse(scRNA)
scRNA %>% dplyr::select(cell_type) %>% summary() %>% knitr::kable("latex")
scRNA %>% dplyr::select(-cell_type)
scRNA %>% dplyr::select(-cell_type) %>%
pivot_longer(everything())
scRNA %>% dplyr::select(-cell_type) %>%
pivot_longer(everything()) %>%
ggplot() + aes(y = value) + geom_histogram()
scRNA %>% dplyr::select(-cell_type) %>%
pivot_longer(everything()) %>%
ggplot() + aes(x = value) + geom_histogram()
scRNA %>% dplyr::select(-cell_type) %>%
pivot_longer(everything()) %>%
ggplot() + aes(x = value, group = name) + geom_histogram()
scRNA %>% dplyr::select(-cell_type) %>%
pivot_longer(everything()) %>% group_by(name) %>%
ggplot() + aes(x = value, color = name) + geom_histogram()
scRNA %>% dplyr::select(-cell_type) %>%
pivot_longer(everything()) %>% group_by(name) %>%
ggplot() + aes(x = value, color = name) + geom_histogram(show.legend = FALSE)
scRNA %>% dplyr::select(cell_type) %>% summary() %>% knitr::kable("latex")
scRNA %>% dplyr::select(cell_type) %>% summary()
scRNA %>% dplyr::select(cell_type) %>% summary() %>% t() %>% knitr::kable("latex")
?filter
habillage
?FactoMineR::PCA
?factoextra::fviz_pca_biplot
scRNA %>% FactoMineR::PCA(graph = FALSE, quali.sup = "celltype")
scRNA %>% FactoMineR::PCA(graph = FALSE, quali.sup = which(colnames(scRNA) == "celltype")= %>%
factoextra::fviz_pca_biplot(select.var = list(contrib = 50))
scRNA %>% FactoMineR::PCA(graph = FALSE, quali.sup = which(colnames(scRNA) == "celltype") %>%
factoextra::fviz_pca_biplot(select.var = list(contrib = 50))
)
scRNA %>% FactoMineR::PCA(graph = FALSE, quali.sup = which(colnames(scRNA) == "celltype")) %>%
factoextra::fviz_pca_biplot(select.var = list(contrib = 50))
scRNA %>% FactoMineR::PCA(graph = FALSE, quali.sup = which(colnames(scRNA) == "celltype"))
scRNA
scRNA %>% FactoMineR::PCA(graph = FALSE)
scRNA %>% FactoMineR::PCA(graph = FALSE, quali.sup = which(colnames(scRNA) == "cell_type")) %>%
factoextra::fviz_pca_biplot(select.var = list(contrib = 50))
scRNA %>% FactoMineR::PCA(graph = FALSE, quali.sup = which(colnames(scRNA) == "cell_type")) %>%
factoextra::fviz_pca_biplot(select.var = list(contrib = 30), habillage = "cell_type")
?PLNmodels::mollusk
PLNmodels::mollusk
mollusc <- PLNmodels::mollusk$Abundance %>% as_tibble()
%>% add_column(site = PLNmodels::mollusk$Covariate$site)
library(tidyverse)
mollusc <- PLNmodels::mollusk$Abundance %>% as_tibble() %>%
add_column(site = PLNmodels::mollusk$Covariate$site)
mollusc
mollusc %>% dplyr::select(site, season) %>% summary()  %>% knitr::kable()
mollusc <- PLNmodels::mollusk$Abundance %>% as_tibble() %>%
add_column(site = PLNmodels::mollusk$Covariate$site,
season = PLNmodels::mollusk$Covariate$season)
mollusc %>% dplyr::select(site, season) %>% summary()  %>% knitr::kable()
mollusc %>% dplyr::select(-site, -season) %>% pivot_longer(everything()) %>%
ggplot() + aes(x = value, color = name) + geom_histogram(show.legend = FALSE)
mollusc %>% dplyr::select(-site, -season) %>% pivot_longer(everything()) %>%
ggplot() + aes(x = value, fill = name) + geom_histogram(show.legend = FALSE)
mollusc %>% dplyr::select(-site, -season) %>% pivot_longer(everything()) %>%
ggplot() + aes(x = value, fill = name) + geom_histogram(show.legend = FALSE)
mollusc
map(mollusc, is.factor)
which(map(mollusc, is.factor))
which(map_lgl(mollusc, is.factor))
mollusc %>% FactoMineR::PCA(graph = FALSE, quali.sup = which(map_lgl(mollusc, is.factor))) %>%
factoextra::fviz_pca_biplot(select.var = list(contrib = 30), habillage = c("season", "site"))
mollusc %>% FactoMineR::PCA(graph = FALSE, quali.sup = which(map_lgl(mollusc, is.factor))) %>%
factoextra::fviz_pca_biplot(select.var = list(contrib = 30), habillage = "site")
mollusc %>% log(1 + .) %>% FactoMineR::PCA(graph = FALSE, quali.sup = which(map_lgl(mollusc, is.factor))) %>%
factoextra::fviz_pca_biplot(select.var = list(contrib = 30), habillage = "site")
mollusk %>% dplyr::select(-site, -season) %>% pivot_longer(everything()) %>%
ggplot() + aes(x = value, fill = name) + coord_trans(y = 'log_10') + geom_histogram(show.legend = FALSE)
mollusk <- PLNmodels::mollusk$Abundance %>% as_tibble() %>%
add_column(site = PLNmodels::mollusk$Covariate$site,
season = PLNmodels::mollusk$Covariate$season)
mollusk %>% dplyr::select(-site, -season) %>% glimpse()
mollusk %>% dplyr::select(site, season) %>% summary()  %>% knitr::kable()
mollusk %>% dplyr::select(-site, -season) %>% pivot_longer(everything()) %>%
ggplot() + aes(x = value, fill = name) + coord_trans(y = 'log_10') + geom_histogram(show.legend = FALSE)
mollusk %>% dplyr::select(-site, -season) %>% pivot_longer(everything()) %>%
ggplot() + aes(x = value, fill = name) + coord_trans(y = log_10) + geom_histogram(show.legend = FALSE)
library(tidyverse)
mollusk %>% dplyr::select(-site, -season) %>% pivot_longer(everything()) %>%
ggplot() + aes(x = value, fill = name) + coord_trans(y = 'log_10') + geom_histogram(show.legend = FALSE)
mollusk %>% dplyr::select(-site, -season) %>% pivot_longer(everything()) %>%
ggplot() + aes(x = value, fill = name) + coord_trans(y = 'log10') + geom_histogram(show.legend = FALSE)
mollusk %>% dplyr::select(-site, -season) %>% pivot_longer(everything()) %>% log(1 + .) %>%
ggplot() + aes(x = value, fill = name) + geom_histogram(show.legend = FALSE)
mollusk %>% dplyr::select(-site, -season) %>% pivot_longer(everything()) %>% ~log(1 + .) %>%
ggplot() + aes(x = value, fill = name) + geom_histogram(show.legend = FALSE)
mollusk %>% dplyr::select(-site, -season) %>% pivot_longer(everything()) %>%
ggplot() + aes(x = log10(1 + value), fill = name) + geom_histogram(show.legend = FALSE)
scRNA
?Rtsne::Rtsne
tSNE_perp5   <- scRNA %>% select(-cell_types) %>% as.matrix() %>% Rtsne::Rtsne(perplexity = 5)
tSNE_perp5   <- scRNA %>% select(-cell_type) %>% as.matrix() %>% Rtsne::Rtsne(perplexity = 5)
tSNE_perp50  <- scRNA %>% select(-cell_type) %>% as.matrix() %>% Rtsne::Rtsne(perplexity = 50)
tSNE_perp500 <- scRNA %>% select(-cell_type) %>% as.matrix() %>% Rtsne::Rtsne(perplexity = 500)
tSNE_perp250 <- scRNA %>% select(-cell_type) %>% as.matrix() %>% Rtsne::Rtsne(perplexity = 500)
tSNE_perp200 <- scRNA %>% select(-cell_type) %>% as.matrix() %>% Rtsne::Rtsne(perplexity = 500)
tSNE_perp100 <- scRNA %>% select(-cell_type) %>% as.matrix() %>% Rtsne::Rtsne(perplexity = 500)
tSNE_perp250 <- scRNA %>% select(-cell_type) %>% as.matrix() %>% Rtsne::Rtsne(perplexity = 250)
tSNE_perp250 <- scRNA %>% select(-cell_type) %>% as.matrix() %>% Rtsne::Rtsne(perplexity = 200)
tSNE_perp250 <- scRNA %>% select(-cell_type) %>% as.matrix() %>% Rtsne::Rtsne(perplexity = 100)
tSNE_perp5   <- scRNA %>% select(-cell_type) %>% as.matrix() %>% Rtsne::Rtsne(perplexity = 5)
tSNE_perp30  <- scRNA %>% select(-cell_type) %>% as.matrix() %>% Rtsne::Rtsne(perplexity = 50)
tSNE_perp100 <- scRNA %>% select(-cell_type) %>% as.matrix() %>% Rtsne::Rtsne(perplexity = 100)
tSNE_perp5
tSNE_perp5   <- scRNA %>% select(-cell_type) %>% as.matrix() %>% Rtsne::Rtsne(perplexity = 5) %>% pull(Y) %>% as_tibble()
scRNA_expr <- scRNA %>% select(-cell_type) %>% as.matrix()
tSNE_perp5   <- scRNA_expr %>% Rtsne::Rtsne(perplexity =   5)$Y %>% as_tibble()
tSNE_perp30  <- scRNA_expr %>% Rtsne::Rtsne(perplexity =  50)$Y %>% as_tibble()
tSNE_perp100 <- scRNA_expr %>% Rtsne::Rtsne(perplexity = 100)$Y %>% as_tibble()
scRNA_expr <- scRNA %>% select(-cell_type) %>% as.matrix()
tSNE_perp5   <- scRNA_expr %>% Rtsne::Rtsne(perplexity =   5)$Y %>% as_tibble()
scRNA_expr %>% Rtsne::Rtsne(perplexity =   5)
scRNA_expr %>% Rtsne::Rtsne(perplexity =   5)$Y
tSNE_perp5   <- scRNA_expr %>% Rtsne::Rtsne(perplexity =   5) %>% as_tibble(.$Y)
tSNE_perp5   <-  Rtsne::Rtsne(scRNA_expr, perplexity =   5)$Y %>% as_tibble()
tSNE_perp5   <-  Rtsne::Rtsne(scRNA_expr, perplexity =   5)$Y %>% as.data.frame()
scRNA_expr <- scRNA %>% select(-cell_type) %>% as.matrix()
tSNE_perp5   <- Rtsne(scRNA_expr, perplexity =   5)$Y %>% as.data.frame() %>% add_column(perplexity = 5)
tSNE_perp30  <- Rtsne(scRNA_expr, perplexity =  50)$Y %>% as.data.frame() %>% add_column(perplexity = 5)
tSNE_perp100 <- Rtsne(scRNA_expr, perplexity = 100)$Y %>% as.data.frame() %>% add_column(perplexity = 5)
library(Rtsne)
<<echo = FALSE, message=FALSE>>=
library(Rtsne)
@
library(Rtsne)
tSNE_perp5   <- Rtsne(scRNA_expr, perplexity =   5)$Y %>% as.data.frame() %>% add_column(perplexity = 5)
tSNE_perp30  <- Rtsne(scRNA_expr, perplexity =  30)$Y %>% as.data.frame() %>% add_column(perplexity = 30)
tSNE_perp100 <- Rtsne(scRNA_expr, perplexity = 100)$Y %>% as.data.frame() %>% add_column(perplexity = 100)
tSNE_perp5   <- Rtsne(scRNA_expr, perplexity =   5)$Y %>%
as.data.frame() %>% add_column(perplexity = 5) %>% add_column(cell_type = scRNA$cell_type)
data.frame(rbind(tSNE_perp5$Y,tSNE_perp30$Y,tSNE_perp100$Y))
tSNE_perp30
scRNA$cell_type
tSNE_perp5   <- Rtsne(scRNA_expr, perplexity =   5)$Y %>%
as.data.frame() %>% add_column(perplexity = 5) %>% add_column(cell_type = scRNA$cell_type)
tSNE_perp30  <- Rtsne(scRNA_expr, perplexity =  30)$Y %>%
as.data.frame() %>% add_column(perplexity = 30) %>% add_column(cell_type = scRNA$cell_type)
tSNE_perp100 <- Rtsne(scRNA_expr, perplexity = 100)$Y %>%
as.data.frame() %>% add_column(perplexity = 100) %>% add_column(cell_type = scRNA$cell_type)
tSNE_perp30
rbind(tSNE_perp5,tSNE_perp30,tSNE_perp100)
rbind(tSNE_perp5,tSNE_perp30,tSNE_perp100) %>%
ggplot(aes(x = V1, y = V2, color = cell_type)) +
geom_point(size=1.25) +
guides(colour = guide_legend(override.aes = list(size=6))) +
facet_wrap(.~perplexity)
rbind(tSNE_perp5,tSNE_perp30,tSNE_perp100) %>%
ggplot(aes(x = V1, y = V2, color = cell_type)) +
geom_point(size=1.25) +
guides(colour = guide_legend(override.aes = list(size=6))) +
facet_grid(.~perplexity, scales = 'free_y')
?facet_wrap
rbind(tSNE_perp5,tSNE_perp30,tSNE_perp100) %>%
ggplot(aes(x = V1, y = V2, color = cell_type)) +
geom_point(size=1.25) +
guides(colour = guide_legend(override.aes = list(size=6))) +
facet_wrap(.~perplexity, scales = 'free')
scRNA_expr <- scRNA %>% select(-cell_type) %>% as.matrix()
tSNE_perp5   <- Rtsne(scRNA_expr, perplexity =   2)$Y %>%
as.data.frame() %>% add_column(perplexity = 5) %>% add_column(cell_type = scRNA$cell_type)
tSNE_perp30  <- Rtsne(scRNA_expr, perplexity =  10)$Y %>%
as.data.frame() %>% add_column(perplexity = 30) %>% add_column(cell_type = scRNA$cell_type)
tSNE_perp100 <- Rtsne(scRNA_expr, perplexity = 100)$Y %>%
as.data.frame() %>% add_column(perplexity = 100) %>% add_column(cell_type = scRNA$cell_type)
rbind(tSNE_perp5,tSNE_perp30,tSNE_perp100) %>%
ggplot(aes(x = V1, y = V2, color = cell_type)) +
geom_point(size=1.25) +
guides(colour = guide_legend(override.aes = list(size=6))) +
facet_wrap(.~perplexity, scales = 'free')
scRNA_expr <- scRNA %>% select(-cell_type) %>% as.matrix()
tSNE_perp5   <- Rtsne(scRNA_expr, perplexity =   2)$Y %>%
as.data.frame() %>% add_column(perplexity = 5) %>% add_column(cell_type = scRNA$cell_type)
tSNE_perp30  <- Rtsne(scRNA_expr, perplexity =  10)$Y %>%
as.data.frame() %>% add_column(perplexity = 30) %>% add_column(cell_type = scRNA$cell_type)
tSNE_perp100 <- Rtsne(scRNA_expr, perplexity = 200)$Y %>%
as.data.frame() %>% add_column(perplexity = 100) %>% add_column(cell_type = scRNA$cell_type)
rbind(tSNE_perp5,tSNE_perp30,tSNE_perp100) %>%
ggplot(aes(x = V1, y = V2, color = cell_type)) +
geom_point(size=1.25) +
guides(colour = guide_legend(override.aes = list(size=6))) +
facet_wrap(.~perplexity, scales = 'free')
.Rtsne
scRNA_expr <- scRNA %>% select(-cell_type) %>% as.matrix()
tSNE_perp5   <- Rtsne(scRNA_expr, perplexity =   2)$Y %>%
as.data.frame() %>% add_column(perplexity = 5) %>% add_column(cell_type = scRNA$cell_type)
tSNE_perp30  <- Rtsne(scRNA_expr, perplexity =  10)$Y %>%
as.data.frame() %>% add_column(perplexity = 30) %>% add_column(cell_type = scRNA$cell_type)
tSNE_perp100 <- Rtsne(scRNA_expr, perplexity = 150)$Y %>%
as.data.frame() %>% add_column(perplexity = 100) %>% add_column(cell_type = scRNA$cell_type)
rbind(tSNE_perp5,tSNE_perp30,tSNE_perp100) %>%
ggplot(aes(x = V1, y = V2, color = cell_type)) +
geom_point(size=1.25) +
guides(colour = guide_legend(override.aes = list(size=6))) +
facet_wrap(.~perplexity, scales = 'free')
mollusk_ab <- mollusk %>% select(-site, -season) %>% as.matrix()
tSNE_perp2   <- Rtsne(log(1 + mollusk_ab), perplexity =   2)$Y %>%
as.data.frame() %>% add_column(perplexity = 2) %>% add_column(site = mollusk$site)
tSNE_perp10  <- Rtsne(log(1 + mollusk_ab), perplexity =  10)$Y %>%
as.data.frame() %>% add_column(perplexity = 10) %>% add_column(site = mollusk$site)
tSNE_perp100 <- Rtsne(log(1 + mollusk_ab), perplexity = 100)$Y %>%
as.data.frame() %>% add_column(perplexity = 100) %>% add_column(site = mollusk$site)
mollusk_ab <- mollusk %>% select(-site, -season) %>% as.matrix()
tSNE_perp2   <- Rtsne(log(1 + mollusk_ab), perplexity =   2)$Y %>%
as.data.frame() %>% add_column(perplexity = 2) %>% add_column(site = mollusk$site)
log(1 + mollusk_ab)
tSNE_perp2   <- Rtsne(mollusk_ab, perplexity =   2)$Y %>%
as.data.frame() %>% add_column(perplexity = 2) %>% add_column(site = mollusk$site)
mollusk_ab
duplicated(mollusk_ab)
?dupplicated
?duplicated
mollusk_ab <- mollusk %>% select(-site, -season, !duplicated(mollusk)) %>% as.matrix()
mollusk_ab <- mollusk %>% select(-site, -season) %>% select(duplicated(mollusk))
mollusk_ab <- mollusk %>% select(-site, -season) %>% select(-which(duplicated(mollusk))) %>%  as.matrix()
-which(duplicated(mollusk))
mollusk %>% select(-site, -season) %>% select(-which(duplicated(mollusk)))
mollusk_ab <- mollusk %>% select(-site, -season) %>% filter(!duplicated(mollusk)) %>%  as.matrix()
tSNE_perp2   <- Rtsne(mollusk_ab, perplexity =   2)$Y %>%
as.data.frame() %>% add_column(perplexity = 2) %>% add_column(site = mollusk$site)
mollusk_ab
duplicated(mollusk_ab)
mollusk_ab <- mollusk %>% select(-site, -season) %>% filter(!duplicated(mollusk)) %>%  as.matrix()
duplicated(mollusk_ab)
!duplicated(mollusk)
mollusk_ab <- mollusk %>% select(-site, -season) %>% filter(!duplicated(.)) %>%  as.matrix()
tSNE_perp2   <- Rtsne(mollusk_ab, perplexity =   2)$Y %>%
as.data.frame() %>% add_column(perplexity = 2) %>% add_column(site = mollusk$site)
duplicated(mollusk %>% select(-site, -season))
duplicated <- duplicated(mollusk %>% select(-site, -season))
mollusk_ab <- mollusk %>% select(-site, -season) %>% filter(!duplicated) %>%  as.matrix()
tSNE_perp2   <- Rtsne(mollusk_ab, perplexity =   2)$Y %>%
as.data.frame() %>% add_column(perplexity = 2) %>% add_column(site = mollusk$site[!duplicated])
tSNE_perp10  <- Rtsne(log(1 + mollusk_ab), perplexity =  10)$Y %>%
as.data.frame() %>% add_column(perplexity = 10) %>% add_column(site = mollusk$site[!duplicated])
tSNE_perp100 <- Rtsne(log(1 + mollusk_ab), perplexity = 100)$Y %>%
as.data.frame() %>% add_column(perplexity = 100) %>% add_column(site = mollusk$site[!duplicated])
tSNE_perp80 <- Rtsne(log(1 + mollusk_ab), perplexity = 100)$Y %>%
as.data.frame() %>% add_column(perplexity = 100) %>% add_column(site = mollusk$site[!duplicated])
tSNE_perp50 <- Rtsne(log(1 + mollusk_ab), perplexity = 80)$Y %>%
as.data.frame() %>% add_column(perplexity = 100) %>% add_column(site = mollusk$site[!duplicated])
tSNE_perp50 <- Rtsne(log(1 + mollusk_ab), perplexity = 50)$Y %>%
as.data.frame() %>% add_column(perplexity = 100) %>% add_column(site = mollusk$site[!duplicated])
duplicated <- duplicated(mollusk %>% select(-site, -season))
mollusk_ab <- mollusk %>% select(-site, -season) %>% filter(!duplicated) %>%  as.matrix()
tSNE_perp2   <- Rtsne(mollusk_ab, perplexity =   2)$Y %>%
as.data.frame() %>% add_column(perplexity = 2) %>% add_column(site = mollusk$site[!duplicated])
tSNE_perp10  <- Rtsne(log(1 + mollusk_ab), perplexity =  10)$Y %>%
as.data.frame() %>% add_column(perplexity = 10) %>% add_column(site = mollusk$site[!duplicated])
tSNE_perp50 <- Rtsne(log(1 + mollusk_ab), perplexity = 50)$Y %>%
as.data.frame() %>% add_column(perplexity = 50) %>% add_column(site = mollusk$site[!duplicated])
rbind(tSNE_perp2,tSNE_perp10,tSNE_perp50) %>%
ggplot(aes(x = V1, y = V2, color = cell_type)) +
geom_point(size=1.25) +
guides(colour = guide_legend(override.aes = list(size=6))) +
facet_wrap(.~perplexity, scales = 'free')
rbind(tSNE_perp2,tSNE_perp10,tSNE_perp50) %>%
ggplot(aes(x = V1, y = V2, color = site)) +
geom_point(size=1.25) +
guides(colour = guide_legend(override.aes = list(size=6))) +
facet_wrap(.~perplexity, scales = 'free')
